<!--
 * @Author: tylerytr
 * @Date: 2023-07-31 11:44:33
 * @LastEditors: tylerytr
 * @LastEditTime: 2023-09-04 00:14:24
 * @FilePath: /Interview_experience/C++基架后端/数据库部分答案.md
 * Email:601576661@qq.com
 * Copyright (c) 2023 by tyleryin, All Rights Reserved. 
-->
#  数据库

1. 说一说mysql的索引，为什么使用B+树（跟B树和hash比）B树和B+树查询有啥区别？IO上有啥区别？还有哪些索引?
2. redis的数据结构
3. redis的string怎么实现的，二进制的结构是什么样子的（没回答上来）
4. 介绍下ES，ES是做什么的，ES为什么能从doc中快速查找
5. mysql主键和非主键区别
    > 主键索引是一种特殊的索引，用于唯一标识表中的每一行数据。在MySQL中，每个表只能有一个主键索引。
    > 主键索引的特点如下：
    > - 唯一性：主键索引中的值必须是唯一的，不允许重复。
    > - 非空性：主键索引中的值不能为空，即主键列不允许为NULL。
    > - 索引速度快：由于主键索引的唯一性，查询速度较快。
    > 非主键索引是指除主键索引以外的其他索引。非主键索引可以是一个或多个列。非主键索引的创建不需要满足唯一性和非空性的要求。
    > 非主键索引的特点如下：
    > - 非唯一性：非主键索引中的值允许重复。
    > - 可为空性：非主键索引中的值允许为NULL。
    > - 索引速度较慢：由于非主键索引的非唯一性，查询速度相对较慢。
6. 2pc提交
    > 可以参考该[知乎](https://zhuanlan.zhihu.com/p/35616810)对于二阶段提交和三阶段提交的比较
7. MapReduce原理；怎么手写
8. mysql的火山模型
9. mysql左连接 右连接 内连接 全外连接
    > 可以参考该[CSDN](https://blog.csdn.net/u011047968/article/details/107744901)
    > 内连接是两个集合的交集，全外连接是两个集合的合集
10. 两个表，A左连接B，建立索引怎么高效
11. ACID解释一下；各个隔离性级别和实现；事务的隔离级别，哪一个隔离级别解决了脏读、幻读
    > 原子性(Atomicity)(一个事务(transaction)中的所有操作，要么全部完成，要么全部不完成，不会结束在中间某个环节。);一致性(consistency)(一个事务执行之前和执行之后数据库都必须处于一致性状态。);隔离性(Isolation)(在并发环境中，当不同的事务同时操纵相同的数据时，每个事务都有各自的完整数据空间。);持久性(Durability)(事务成功结束，它对数据库所做的更新就必须永久保存下来。); ACID中，C是目的，AID是手段
    > 四个隔离级别(由弱到强):
    > 1. 未提交读：SELECT语句以非锁定方式被执行，所以有可能读到脏数据，隔离级别最低。
    > 2. 提交读：只能读取到已经提交的数据。即解决了脏读，但未解决不可重复读。
    > 3. 可重复读：在同一个事务内的查询都是事务开始时刻一致的，InnoDB的默认级别。在SQL标准中，该隔离级别消除了不可重复读，但是还存在幻读。
    > 4. 串行读：完全的串行化读，所有SELECT语句都被隐式的转换成SELECT ... LOCK IN SHARE MODE，即读取使用表级共享锁，读写相互都会阻塞。隔离级别最高。
    > 四种不一致现象：
    > 1. 脏读：对脏数据（Drity Data）的读取，而脏数据所指的就是未提交的数据。其他事务未提交的修改
    > 2. 不可重复读：一个事务先后读取同一条记录，但两次读取的数据不同。读取之间被人改了
    > 3. 幻读：一个事务中, 执行相同的查询多次, 结果不同。其他事务已提交的插入操作
    > 4. 丢失修改：一个修改破坏另一个修改结果；	多个事务并发修改同一个数据

12. 二级索引解释一下；主索引/辅助索引；
    > 1. **一级索引**中索引和数据存储在一起，都存储在同一个B+tree中的叶子节点。一般主键索引都是一级索引。**二级索引**中树的叶子节点存储的是主键而不是数据。也就是说，在找到索引后，得到对应的主键，再回到一级索引中找主键对应的数据记录。
    > 2. **辅助索引** (Secondary Index) , 叶子节点只保存了行的键值和指向主索引对应行的“指针”；**主索引**是基于表的主键（Primary Key）构建的索引
13. Mysql有哪些存储引擎；InnoDB和MyIsam的区别
    > 可以参考https://www.runoob.com/w3cnote/mysql-different-nnodb-myisam.html 

14. 聚簇索引
    > 聚簇索引的叶子节点就是数据节点，也就是说索引和数据行在一起，存了主键和数据。默认由主键实现,一个表只有一个。(比如InnoDB的实现)
    > 非聚簇索引的叶子节点里面存的不是数据而是主键和指向数据的指针(比如MyIsam的实现)

15. 表有字段姓名 性别 年龄 班级 该怎么建立索引提高查找效率
16. mvcc机制
    > MVCC是指多版本并发控制;
    > 可以参考该[博客](https://pdai.tech/md/db/sql-mysql/sql-mysql-mvcc.html)
    > 需要了解当前读和快照读是什么；
    > MVCC多版本并发控制指的是 “维持一个数据的多个版本，使得读写操作没有冲突” 这么一个概念，是一种基于日志的无锁并发控制，为了解决快照读的读写冲突
    > MVCC的实现基于**4个隐式字段，undo日志 ，Read View**


17. 写个sql,今日消费最多的前10个人
18. 说说 MySQL 索引（B-Tree索引、哈希索引、R-Tree索引、全文索引等等）
19. 数据一致性检验
    > 可以使用该[博客](https://cloud.tencent.com/developer/article/1671527)中的percona-toolkit的 pt-table-checksum进行检测MySQL主从数据一致性;原理为在主库执行基于statement的sql语句来生成主库数据块的checksum，把相同的sql语句传递到从库执行，并在从库上计算相同数据块的checksum，最后，比较主从库上相同数据块的checksum值，由此判断主从数据是否一致。
20. 
