<!--
 * @Author: tylerytr
 * @Date: 2023-07-31 11:41:03
 * @LastEditors: tylerytr
 * @LastEditTime: 2023-08-10 10:03:07
 * @FilePath: /Interview_experience/C++基架后端/系统部分答案.md
 * Email:601576661@qq.com
 * Copyright (c) 2023 by tyleryin, All Rights Reserved. 
-->
# 系统

1. 增加CPU的数量，会对CPU密集型或IO密集型的任务性能处理有提升吗？
> CPU密集型有提升大，IO密集型提升小或没有提升
2. CPU多级缓存，为什么这么设计？
> 单级缓存无法同时做到访问速度快（需要尽可能贴近CPU）、容量大（需要占用更大的面积），用多级缓存可以利用局部性原理同时满足快速和大容量，工业实践的结果认为3级缓存比较平衡
3. 用户态和内核态区别是什么？
> 内核态/用户态本质上是CPU执行指令的特权级，内核态可以执行一些特权指令
> 常见的系统调用:文件操作系统的系统调用(create,open,read,write,close,link,unlink,lseek,chmod,rename)，控制类的系统调用(fork,wait,exit,exec)，信号和时间类的调用(kill,sigaction,sigreturn,stime,time,times);含义可以参考[该博客](https://blog.csdn.net/leapembedded/article/details/8720688)
4. 用户态和内核态切换的主要开销在哪里
> 保存寄存器（直接开销小）、检查权限、打乱执行流（间接开销小）、切换到内核栈（缓存冷，间接开销大），如果是系统调用还需要来回拷贝参数（直接开销大）
5. 什么是零拷贝？
> 通过网卡传输磁盘文件的场景，传统需要4次内存拷贝（磁盘-内核态-用户态-内核态-网卡），其中中间两次需要CPU参与（内核态-用户态-内核态）；使用mmap+write()可以消除内核态-用户态拷贝；使用sendfile()可以消除所有CPU参与的拷贝（磁盘-内核态-网卡，两次拷贝都由硬件DMA完成）;可以参考[我的博客](https://tyler-ytr.github.io/2022/04/16/RDMA-learning/#DMA%E6%8A%80%E6%9C%AF%E4%B8%8E%E9%9B%B6%E6%8B%B7%E8%B4%9D)
6. 同步IO和异步IO的区别，阻塞IO和非阻塞IO的区别，是否存在同步非阻塞IO？
> 同步/异步IO 的区别在于数据搬运 是/否 由调用IO函数的进程完成；非阻塞/阻塞IO 的区别在于IO未准备好时函数调用 会/不会 立即返回；同步非阻塞就是轮询;可以参考[该博客](https://www.cnblogs.com/loveer/p/11479249.html)
7. 操作系统有哪些主要功能？
8. 物理地址在cache中的映射关系


## 进程管理

1. 进程和线程区别和联系
> 教科书：进程是资源分配的基本单位，线程是调度的基本单位；Linux：线程就是轻量级进程，都用task_struct描述，线程共享虚拟内存、文件、信号等多数进程资源，但独立调度
1. Python/Java/C++里面的线程有什么不一样？
> C++线程就是系统线程，Python/Java都是虚拟机封装后的系统线程（尽管都是一对一的），Python由于有GIL所以多线程只能提升IO不能提升计算性能
1. 时间片是什么
> 操作系统调度到一个进程时，给进程分配的执行时间
1. 进程、线程、协程切换的开销分别是什么
2. 进程通信方式
> [进程通信例程](https://blog.csdn.net/qq_38048756/article/details/109394362)
1. 讲讲 fork() 函数
2. Linux 杀死进程的过程

## 内存管理

1. 操作系统页面置换算法
2. 分页机制、缺页中断、为什么有页表
3. 操作系统里面分配内存和管理内存，怎么做的

## 文件系统

1. write操作发生了什么
>  1. 可以参考[该专栏](https://zhuanlan.zhihu.com/p/142441899)
>  2. 关键技术是内核缓冲区。
>  3. 简要而言：write操作会1.调用系统调用2.系统调用会调用vfs_write然后返回；3. 此时数据会进入内核缓冲区；操作系统会在后台收集所有的“脏”数据按照顺序在某一个时刻写入磁盘。写入的时机包括：1.脏页超过上限2.dirty_expire_interval超时;
>  4. 如何保证落盘：参考[该文章](https://www.markjour.com/article/20221110-linux-sync.html)；
   文件数据从应用程序写入磁盘，需要经过多个缓冲区：应用本身的缓冲区，库的缓冲区，操作系统缓冲区，磁盘缓冲区；还在缓冲区的时候掉电就会丢失数据
   可以使用fsync/fdatasync系统调用刷新缓冲区，在开启写屏障的时候能够写入持久化设备(不开启的话可能会在磁盘缓存里面)
2.  write的用户态内核态操作，数据要拷贝到内核态吗，如果突然宕机了会有没写的吗？怎么刷新缓冲区呢？这块系统调用是什么呢？
3.  讲一讲怎么看文件权限？文件权限是怎么实现的？
> 1. ls -l
> 2. 文件权限位于inode中；关于linux文件权限的更多内容可以参考[Linux文件权限](https://tyler-ytr.github.io/2023/04/25/linux%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/#%E8%A1%A5%E5%85%85%EF%BC%9ALinux%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90)
4.  Linux 文件描述符 vs. 文件句柄

## 并发
1. 服务器多线程如何防止数据冲突
2. 什么是线程安全？设置静态变量怎么保证线程安全？
3. 死锁产生的条件；设计一种通用性算法，怎么检测一个死锁；
4. (Java) 说说ThreadLocal
5. (Java) 多线程wait notify join

## Linux 使用

1. 用 cat 和 grep 根据关键字查找日志
2. grep 查找前边的十行，用什么参数
3. 用什么工具调试内存泄漏，怎么定位？
4. Git 底层
5. 是否用过 Linux，常用命令
